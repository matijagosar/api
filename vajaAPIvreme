import sys
import requests
import datetime

koordinate = [
    {"ime": "Ljubljana", "lat": 46.05, "lon": 14.51},
    {"ime": "London", "lat": 51.51, "lon": -0.13},
    {"ime": "New York", "lat": 40.71, "lon": -74.01},
    {"ime": "Tokyo", "lat": 35.68, "lon": 139.69},
    {"ime": "Sydney", "lat": -33.87, "lon": 151.21},
    {"ime": "Kairo", "lat": 30.04, "lon": 31.24},
    {"ime": "São Paulo", "lat": -23.55, "lon": -46.63},
    {"ime": "Mumbai", "lat": 19.08, "lon": 72.88}
]


# 1: Poišči mesto z najvišjo maksimalno temperaturo v naslednjih 7 dneh
# Namig: Uporabi max() na ["daily"]["temperature_2m_max"]
"""max_tmp=0
mesto=""
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    maksimalno=max(klic["daily"]["temperature_2m_max"])
    if maksimalno>max_tmp:
        max_tmp=maksimalno
        mesto=dict["ime"]
print(mesto)"""
# 2: Katero mesto bo imelo največ padavin skupaj v naslednjih 7 dneh?
# Namig: Seštej vse vrednosti v ["daily"]["precipitation_sum"]
"""max_rain=0
mesto=""
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    sestevek=sum(klic["daily"]["precipitation_sum"])
    if sestevek>max_rain:
        max_rain=sestevek
        mesto=dict["ime"]
print(mesto)"""
# 3: Najdi najhladneje mesto v naslednjih 7 dneh
# Namig: Nekatera mesta lahko nimajo podatkov, preveri dolžino seznama!
"""min_temp=sys.maxsize
mesto=""
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    minimalno=sum(klic["daily"]["temperature_2m_min"])/len(klic["daily"]["temperature_2m_min"])
    if minimalno<min_temp:
        min_temp=minimalno
        mesto=dict["ime"]
print(mesto)"""
# 4: Poišči mesto z največjim temperaturnim razponom (max - min) za prvi dan
# Namig: Uporabi indeks [0] za prvi dan napovedi
"""max_razpon=0
mesto=""
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    razpon=klic["daily"]["temperature_2m_max"][0]-klic["daily"]["temperature_2m_min"][0]
    print(razpon)
    if razpon>max_razpon:
        max_razpon=razpon
        mesto=dict["ime"]
print(mesto)"""
# 5: Izpiši vsa mesta, kjer bo jutri padalo (precipitation_sum[1] > 0)
# Namig: Jutri je na indeksu [1], danes je [0]
"""for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    padavine=klic["daily"]["precipitation_sum"][1]
    if padavine>0:
        print(dict["ime"])"""
# 6: Koliko mest bo imelo jutri maksimalno temperaturo nad 20°C?
# Namig: Preštej mesta, kjer je temperature_2m_max[1] > 20
"""count=0
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    max_temp=klic["daily"]["temperature_2m_max"][1]
    print(max_temp)
    if max_temp>20:
        count+=1
print(count)"""
# 7: Katero mesto ima najhitrejši veter v naslednjih 7 dneh? Izpiši tudi hitrost vetra.
# Namig: Preveri max() vrednost v ["daily"]["wind_speed_10m_max"]
"""max_wind=0
mesto=""
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    wind=max(klic["daily"]["wind_speed_10m_max"])
    if wind>max_wind:
        max_wind=wind
        mesto=dict["ime"]
print(mesto)"""
# 8: V katerem mestu je najdaljši dan (razlika med zahodom in vzhodom sonca)?
# Namig: Uporabi DateTime https://www.w3schools.com/python/python_datetime.asp
"""max_length=0
mesto=""
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum,daylight_duration&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    length=klic["daily"]["daylight_duration"][0]
    if length>max_length:
        max_length=length
        mesto=dict["ime"]
print(mesto)"""
# 9: Ugotovi, koliko mest bo  v naslednjih 7 dneh brez padavin
# Namig: Preveri, če ima mesto vsaj eno ničlo v precipitation_sum
"""count=0
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    sestevek=sum(klic["daily"]["precipitation_sum"])
    if sestevek>0:
        count+=1
print(count)"""
# 10: Poljubna naloga!
# izpisi povprecje padavin cez cel teden za vsako mesto
for dict in koordinate:
    lat=dict["lat"]
    lon=dict["lon"]
    url=f"https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&daily=temperature_2m_max,sunset,sunrise,rain_sum,temperature_2m_min,wind_speed_10m_max,precipitation_sum&timezone=Europe%2FBerlin"
    klic=requests.get(url).json()
    povprecje=round(sum(klic["daily"]["temperature_2m_max"])/len(klic["daily"]["temperature_2m_max"]),2)
    print(dict["ime"],povprecje)